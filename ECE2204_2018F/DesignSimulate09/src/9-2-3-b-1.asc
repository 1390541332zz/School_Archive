Version 4
SHEET 1 880 680
WIRE 272 -16 240 -16
WIRE 368 -16 336 -16
WIRE -16 0 -32 0
WIRE 48 0 -16 0
WIRE -32 64 -32 0
WIRE 416 64 240 64
WIRE 464 64 416 64
WIRE 512 64 464 64
WIRE 416 80 416 64
WIRE -32 160 -32 144
WIRE 0 160 -32 160
WIRE 48 160 48 80
WIRE 48 160 0 160
WIRE 240 160 240 144
WIRE 272 160 240 160
WIRE 368 160 368 -16
WIRE 368 160 336 160
WIRE 416 160 416 144
WIRE 416 160 368 160
WIRE 512 160 512 144
WIRE 512 160 416 160
WIRE 416 176 416 160
FLAG -16 0 Vin
FLAG 0 240 0
FLAG 464 64 o
FLAG 416 176 0
SYMBOL voltage -32 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 -27 90 VRight 2
WINDOW 3 -54 -98 VRight 2
SYMATTR SpiceLine Rser=1n
SYMATTR Value SINE(0 {1.414*120} {Fs})
SYMATTR InstName Vs
SYMBOL ind2 32 96 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Lp
SYMATTR Value {Lp}
SYMATTR Type ind
SYMBOL ind2 256 80 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Lsh
SYMATTR Value {Ls}
SYMATTR Type ind
SYMBOL res 496 48 R0
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL cap 400 80 R0
SYMATTR InstName C1
SYMATTR Value {Cf}
SYMBOL res -16 144 R0
SYMATTR InstName Riso
SYMATTR Value 1g
SYMBOL ind2 256 160 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Lsl
SYMATTR Value {Ls}
SYMATTR Type ind
SYMBOL diode 272 176 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value Dpw
SYMBOL diode 272 0 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value Dpw
TEXT 104 240 Left 2 !.param Fs=60 Ts=1/Fs tr=12.86 Lp=10 Ls=Lp/tr**2 R1=17k
TEXT 104 264 Left 2 !.MODEL Dpw D(Vfwd=1.2, Ron=1)
TEXT 64 -40 Left 2 !Kps Lp Lsh Lsl 1
TEXT 104 288 Left 2 !.step param Cf list 0 1u 0.118m
TEXT 104 312 Left 2 !.tran 0 {2.5*Ts} {Ts} {Ts/250}
